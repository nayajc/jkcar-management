<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JKCar Management - ì‚¬ê³ ê´€ë¦¬</title>
  <?!= include('styles'); ?>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <a href="?page=home" class="logo">
          ğŸš— JKCar Management
        </a>
        <nav class="nav">
          <a href="?page=dashboard" class="nav-link">ğŸ“Š ëŒ€ì‹œë³´ë“œ</a>
          <a href="?page=vehicles" class="nav-link">ğŸš— ì°¨ëŸ‰ê´€ë¦¬</a>
          <a href="?page=accidents" class="nav-link active">ğŸ“ ì‚¬ê³ ê´€ë¦¬</a>
          <a href="?page=maintenance" class="nav-link">ğŸ”§ ì •ë¹„ê´€ë¦¬</a>
          <a href="?page=profile" class="nav-link">ğŸ‘¤ í”„ë¡œí•„</a>
        </nav>
        <button class="mobile-menu-btn" onclick="toggleMobileMenu()">â˜°</button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main">
    <div class="container">
      <!-- Page Header -->
      <section class="page-header mb-6">
        <div class="card">
          <div class="page-header-content">
            <div class="page-header-text">
              <h1>ğŸ“ ì‚¬ê³  ê´€ë¦¬</h1>
              <p>ì‚¬ê³  ë°œìƒ ì‹œ ìƒì„¸í•œ ì •ë³´ì™€ ì‚¬ì§„ì„ ê¸°ë¡í•˜ì—¬ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ì„¸ìš”.</p>
            </div>
            <div class="page-header-actions">
              <button class="btn btn-warning" onclick="showAddAccidentModal()">
                ğŸ“ ìƒˆ ì‚¬ê³  ê¸°ë¡
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- Accident Stats -->
      <section class="accident-stats mb-6">
        <div class="grid grid-4">
          <div class="stats-card">
            <div class="stats-number" id="total-accidents">0</div>
            <div class="stats-label">ì´ ì‚¬ê³  ê±´ìˆ˜</div>
          </div>
          <div class="stats-card">
            <div class="stats-number" id="this-year">0</div>
            <div class="stats-label">ì˜¬í•´ ì‚¬ê³ </div>
          </div>
          <div class="stats-card">
            <div class="stats-number" id="this-month">0</div>
            <div class="stats-label">ì´ë²ˆ ë‹¬</div>
          </div>
          <div class="stats-card">
            <div class="stats-number" id="pending">0</div>
            <div class="stats-label">ì²˜ë¦¬ ëŒ€ê¸°</div>
          </div>
        </div>
      </section>

      <!-- Accident List -->
      <section class="accident-list">
        <div class="card-header">
          <h2 class="section-title">ğŸ“‹ ì‚¬ê³  ê¸°ë¡ ëª©ë¡</h2>
          <div class="list-actions">
            <select id="filter-status" class="form-input">
              <option value="">ëª¨ë“  ìƒíƒœ</option>
              <option value="pending">ì²˜ë¦¬ ëŒ€ê¸°</option>
              <option value="in-progress">ì²˜ë¦¬ ì¤‘</option>
              <option value="completed">ì™„ë£Œ</option>
            </select>
            <input type="text" id="search-accidents" class="form-input" placeholder="ì‚¬ê³  ê²€ìƒ‰">
          </div>
        </div>
        <div id="accidents-container">
          <!-- ì‚¬ê³  ëª©ë¡ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
        </div>
      </section>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2024 JKCar Management. All rights reserved.</p>
    </div>
  </footer>

  <?!= include('script'); ?>

  <script>
  // ì‚¬ê³  ëª©ë¡ ë¡œë“œ
  function loadAccidents() {
    google.script.run
      .withSuccessHandler(function(accidentList) {
        accidents = accidentList;
        renderAccidents();
        updateAccidentStats();
      })
      .withFailureHandler(function(error) {
        console.error('ì‚¬ê³  ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
        showAlert('ì‚¬ê³  ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
      })
      .getAccidents();
  }

  // ì‚¬ê³  ëª©ë¡ ë Œë”ë§
  function renderAccidents() {
    const container = document.getElementById('accidents-container');
    if (!container) return;

    if (accidents.length === 0) {
      container.innerHTML = `
        <div class="card text-center">
          <div class="mb-4">ğŸ“</div>
          <h3>ë“±ë¡ëœ ì‚¬ê³  ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</h3>
          <p class="text-gray-600 mb-4">ì²« ë²ˆì§¸ ì‚¬ê³  ê¸°ë¡ì„ ë“±ë¡í•´ë³´ì„¸ìš”.</p>
          <button class="btn btn-warning" onclick="showAddAccidentModal()">
            ì‚¬ê³  ê¸°ë¡í•˜ê¸°
          </button>
        </div>
      `;
      return;
    }

    container.innerHTML = accidents.map(accident => `
      <div class="accident-card card mb-4">
        <div class="accident-header">
          <div class="accident-info">
            <h3>${accident.vehiclePlate} - ${accident.accidentType}</h3>
            <p class="accident-date">${formatDate(accident.accidentDate)}</p>
          </div>
          <div class="accident-status">
            <span class="status-badge status-${accident.status}">${getStatusText(accident.status)}</span>
          </div>
        </div>
        <div class="accident-details">
          <div class="detail-row">
            <span class="detail-label">ì‚¬ê³  ìœ í˜•:</span>
            <span class="detail-value">${accident.accidentType}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">ì‚¬ê³  ì¥ì†Œ:</span>
            <span class="detail-value">${accident.location}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">ìƒëŒ€ë°©:</span>
            <span class="detail-value">${accident.otherDriverName || 'ì •ë³´ ì—†ìŒ'}</span>
          </div>
        </div>
        <div class="accident-actions">
          <button class="btn btn-sm btn-primary" onclick="viewAccidentDetails('${accident.id}')">
            ğŸ‘ï¸ ìƒì„¸ë³´ê¸°
          </button>
          <button class="btn btn-sm btn-secondary" onclick="editAccident('${accident.id}')">
            âœï¸ ìˆ˜ì •
          </button>
          <button class="btn btn-sm btn-error" onclick="deleteAccident('${accident.id}')">
            ğŸ—‘ï¸ ì‚­ì œ
          </button>
        </div>
      </div>
    `).join('');
  }

  // ìƒíƒœ í…ìŠ¤íŠ¸ ë°˜í™˜
  function getStatusText(status) {
    switch(status) {
      case 'pending': return 'ì²˜ë¦¬ ëŒ€ê¸°';
      case 'in-progress': return 'ì²˜ë¦¬ ì¤‘';
      case 'completed': return 'ì™„ë£Œ';
      default: return 'ì•Œ ìˆ˜ ì—†ìŒ';
    }
  }

  // ì‚¬ê³  í†µê³„ ì—…ë°ì´íŠ¸
  function updateAccidentStats() {
    const total = accidents.length;
    const thisYear = accidents.filter(a => {
      const accidentYear = new Date(a.accidentDate).getFullYear();
      return accidentYear === new Date().getFullYear();
    }).length;
    const thisMonth = accidents.filter(a => {
      const accidentDate = new Date(a.accidentDate);
      const now = new Date();
      return accidentDate.getFullYear() === now.getFullYear() && 
             accidentDate.getMonth() === now.getMonth();
    }).length;
    const pending = accidents.filter(a => a.status === 'pending').length;

    document.getElementById('total-accidents').textContent = total;
    document.getElementById('this-year').textContent = thisYear;
    document.getElementById('this-month').textContent = thisMonth;
    document.getElementById('pending').textContent = pending;
  }

  // ìƒˆ ì‚¬ê³  ê¸°ë¡ ëª¨ë‹¬ í‘œì‹œ
  function showAddAccidentModal() {
    const modal = document.createElement('div');
    modal.className = 'modal-overlay';
    modal.innerHTML = `
      <div class="modal-content modal-large">
        <div class="modal-header">
          <h2>ğŸ“ ìƒˆ ì‚¬ê³  ê¸°ë¡</h2>
          <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-body">
          <form id="accident-form">
            <div class="form-section">
              <h3>ğŸš— ì°¨ëŸ‰ ì •ë³´</h3>
              <div class="grid grid-2">
                <div class="form-group">
                  <label for="vehiclePlate" class="form-label">ì°¨ëŸ‰ ë²ˆí˜¸íŒ *</label>
                  <select id="vehiclePlate" class="form-input" required>
                    <option value="">ì°¨ëŸ‰ ì„ íƒ</option>
                    ${vehicles.map(v => `<option value="${v.plateNumber}">${v.plateNumber} - ${v.make} ${v.model}</option>`).join('')}
                  </select>
                </div>
                <div class="form-group">
                  <label for="accidentDate" class="form-label">ì‚¬ê³  ë°œìƒì¼ *</label>
                  <input type="datetime-local" id="accidentDate" class="form-input" required>
                </div>
              </div>
            </div>

            <div class="form-section">
              <h3>ğŸ“‹ ì‚¬ê³  ì •ë³´</h3>
              <div class="grid grid-2">
                <div class="form-group">
                  <label for="accidentType" class="form-label">ì‚¬ê³  ìœ í˜• *</label>
                  <select id="accidentType" class="form-input" required>
                    <option value="">ì‚¬ê³  ìœ í˜• ì„ íƒ</option>
                    <option value="ì ‘ì´‰ì‚¬ê³ ">ì ‘ì´‰ì‚¬ê³ </option>
                    <option value="ì¶”ëŒì‚¬ê³ ">ì¶”ëŒì‚¬ê³ </option>
                    <option value="ì¸¡ë©´ì¶©ëŒ">ì¸¡ë©´ì¶©ëŒ</option>
                    <option value="í›„ë°©ì¶©ëŒ">í›„ë°©ì¶©ëŒ</option>
                    <option value="ë³´í–‰ìì‚¬ê³ ">ë³´í–‰ìì‚¬ê³ </option>
                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="severity" class="form-label">ì‚¬ê³  ì‹¬ê°ë„</label>
                  <select id="severity" class="form-input">
                    <option value="ê²½ë¯¸">ê²½ë¯¸</option>
                    <option value="ë³´í†µ">ë³´í†µ</option>
                    <option value="ì‹¬ê°">ì‹¬ê°</option>
                    <option value="ì¹˜ëª…ì ">ì¹˜ëª…ì </option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label for="description" class="form-label">ì‚¬ê³  ìƒì„¸ ì„¤ëª…</label>
                <textarea id="description" class="form-textarea" placeholder="ì‚¬ê³  ë°œìƒ ìƒí™©ì„ ìì„¸íˆ ì„¤ëª…í•´ì£¼ì„¸ìš”..."></textarea>
              </div>
            </div>

            <div class="form-section">
              <h3>ğŸ“ ìœ„ì¹˜ ì •ë³´</h3>
              <div class="form-group">
                <label for="location" class="form-label">ì‚¬ê³  ë°œìƒ ì¥ì†Œ *</label>
                <input type="text" id="location" class="form-input" placeholder="ì£¼ì†Œ ë˜ëŠ” ì¥ì†Œëª…" required>
              </div>
              <div class="form-group">
                <button type="button" class="btn btn-secondary" onclick="getCurrentLocationForAccident()">
                  ğŸ“ í˜„ì¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
                </button>
              </div>
            </div>

            <div class="form-section">
              <h3>ğŸ‘¤ ìƒëŒ€ë°© ì •ë³´</h3>
              <div class="grid grid-2">
                <div class="form-group">
                  <label for="otherDriverName" class="form-label">ìƒëŒ€ë°© ìš´ì „ì ì´ë¦„</label>
                  <input type="text" id="otherDriverName" class="form-input">
                </div>
                <div class="form-group">
                  <label for="otherDriverPhone" class="form-label">ìƒëŒ€ë°© ì—°ë½ì²˜</label>
                  <input type="tel" id="otherDriverPhone" class="form-input">
                </div>
                <div class="form-group">
                  <label for="otherDriverLicense" class="form-label">ìƒëŒ€ë°© ë©´í—ˆë²ˆí˜¸</label>
                  <input type="text" id="otherDriverLicense" class="form-input">
                </div>
                <div class="form-group">
                  <label for="otherVehiclePlate" class="form-label">ìƒëŒ€ë°© ì°¨ëŸ‰ë²ˆí˜¸</label>
                  <input type="text" id="otherVehiclePlate" class="form-input">
                </div>
              </div>
            </div>

            <div class="form-section">
              <h3>ğŸ“¸ ì‚¬ì§„ ì—…ë¡œë“œ</h3>
              <div class="photo-upload-grid">
                <div class="photo-upload-item">
                  <label for="myVehiclePhoto" class="photo-upload-label">
                    <div class="photo-upload-box">
                      <span>ğŸš—</span>
                      <p>ë‚´ ì°¨ëŸ‰ ì‚¬ì§„</p>
                    </div>
                  </label>
                  <input type="file" id="myVehiclePhoto" class="photo-upload-input" accept="image/*" onchange="previewImage(this, 'myVehiclePreview')">
                  <div id="myVehiclePreview" class="photo-preview"></div>
                </div>
                <div class="photo-upload-item">
                  <label for="otherVehiclePhoto" class="photo-upload-label">
                    <div class="photo-upload-box">
                      <span>ğŸš™</span>
                      <p>ìƒëŒ€ë°© ì°¨ëŸ‰ ì‚¬ì§„</p>
                    </div>
                  </label>
                  <input type="file" id="otherVehiclePhoto" class="photo-upload-input" accept="image/*" onchange="previewImage(this, 'otherVehiclePreview')">
                  <div id="otherVehiclePreview" class="photo-preview"></div>
                </div>
                <div class="photo-upload-item">
                  <label for="accidentScenePhoto" class="photo-upload-label">
                    <div class="photo-upload-box">
                      <span>ğŸ“</span>
                      <p>ì‚¬ê³  í˜„ì¥ ì‚¬ì§„</p>
                    </div>
                  </label>
                  <input type="file" id="accidentScenePhoto" class="photo-upload-input" accept="image/*" onchange="previewImage(this, 'accidentScenePreview')">
                  <div id="accidentScenePreview" class="photo-preview"></div>
                </div>
                <div class="photo-upload-item">
                  <label for="driverLicensePhoto" class="photo-upload-label">
                    <div class="photo-upload-box">
                      <span>ğŸªª</span>
                      <p>ìš´ì „ë©´í—ˆì¦ ì‚¬ì§„</p>
                    </div>
                  </label>
                  <input type="file" id="driverLicensePhoto" class="photo-upload-input" accept="image/*" onchange="previewImage(this, 'driverLicensePreview')">
                  <div id="driverLicensePreview" class="photo-preview"></div>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal()">ì·¨ì†Œ</button>
          <button class="btn btn-warning" onclick="saveAccident()">
            <span class="loading hidden"></span>
            ì‚¬ê³  ê¸°ë¡ ì €ì¥
          </button>
        </div>
      </div>
    `;
    document.body.appendChild(modal);
  }

  // í˜„ì¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
  function getCurrentLocationForAccident() {
    getCurrentLocation(function(location) {
      if (location) {
        // ì‹¤ì œë¡œëŠ” Google Maps Geocoding APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì£¼ì†Œ ë³€í™˜
        document.getElementById('location').value = `${location.lat}, ${location.lng}`;
        showAlert('í˜„ì¬ ìœ„ì¹˜ê°€ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
      } else {
        showAlert('ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
      }
    });
  }

  // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
  function previewImage(input, previewId) {
    const preview = document.getElementById(previewId);
    const file = input.files[0];
    
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        preview.innerHTML = `
          <img src="${e.target.result}" alt="ë¯¸ë¦¬ë³´ê¸°" style="max-width: 100%; height: auto; border-radius: 0.5rem;">
          <button type="button" class="btn btn-sm btn-error" onclick="removeImage('${input.id}', '${previewId}')" style="margin-top: 0.5rem;">
            ì‚­ì œ
          </button>
        `;
      };
      reader.readAsDataURL(file);
    }
  }

  // ì´ë¯¸ì§€ ì œê±°
  function removeImage(inputId, previewId) {
    document.getElementById(inputId).value = '';
    document.getElementById(previewId).innerHTML = '';
  }

  // ì‚¬ê³  ê¸°ë¡ ì €ì¥
  function saveAccident() {
    const accidentData = {
      vehiclePlate: document.getElementById('vehiclePlate').value,
      accidentDate: document.getElementById('accidentDate').value,
      accidentType: document.getElementById('accidentType').value,
      severity: document.getElementById('severity').value,
      description: document.getElementById('description').value,
      location: document.getElementById('location').value,
      otherDriverName: document.getElementById('otherDriverName').value,
      otherDriverPhone: document.getElementById('otherDriverPhone').value,
      otherDriverLicense: document.getElementById('otherDriverLicense').value,
      otherVehiclePlate: document.getElementById('otherVehiclePlate').value,
      status: 'pending',
      photos: {
        myVehicle: document.getElementById('myVehiclePhoto').files[0],
        otherVehicle: document.getElementById('otherVehiclePhoto').files[0],
        accidentScene: document.getElementById('accidentScenePhoto').files[0],
        driverLicense: document.getElementById('driverLicensePhoto').files[0]
      }
    };

    if (!accidentData.vehiclePlate || !accidentData.accidentDate || !accidentData.accidentType || !accidentData.location) {
      showAlert('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
      return;
    }

    const button = document.querySelector('.modal-footer .btn-warning');
    const loading = button.querySelector('.loading');
    
    button.disabled = true;
    loading.classList.remove('hidden');

    // ì‹¤ì œë¡œëŠ” Firebase Storageì— ì´ë¯¸ì§€ ì—…ë¡œë“œ í›„ URL ì €ì¥
    google.script.run
      .withSuccessHandler(function(result) {
        if (result.success) {
          showAlert('ì‚¬ê³  ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“', 'success');
          closeModal();
          loadAccidents();
        } else {
          showAlert(result.message, 'error');
        }
      })
      .withFailureHandler(function(error) {
        showAlert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
      })
      .withFinally(function() {
        button.disabled = false;
        loading.classList.add('hidden');
      })
      .saveAccident(accidentData);
  }

  // ì‚¬ê³  ìƒì„¸ë³´ê¸°
  function viewAccidentDetails(accidentId) {
    const accident = accidents.find(a => a.id === accidentId);
    if (!accident) {
      showAlert('ì‚¬ê³  ê¸°ë¡ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
      return;
    }

    const modal = document.createElement('div');
    modal.className = 'modal-overlay';
    modal.innerHTML = `
      <div class="modal-content modal-large">
        <div class="modal-header">
          <h2>ğŸ“ ì‚¬ê³  ìƒì„¸ì •ë³´</h2>
          <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-body">
          <div class="accident-detail-grid">
            <div class="detail-section">
              <h3>ğŸš— ì°¨ëŸ‰ ì •ë³´</h3>
              <div class="detail-item">
                <span class="detail-label">ì°¨ëŸ‰ ë²ˆí˜¸íŒ:</span>
                <span class="detail-value">${accident.vehiclePlate}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ì‚¬ê³  ë°œìƒì¼:</span>
                <span class="detail-value">${formatDate(accident.accidentDate)}</span>
              </div>
            </div>
            <div class="detail-section">
              <h3>ğŸ“‹ ì‚¬ê³  ì •ë³´</h3>
              <div class="detail-item">
                <span class="detail-label">ì‚¬ê³  ìœ í˜•:</span>
                <span class="detail-value">${accident.accidentType}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ì‹¬ê°ë„:</span>
                <span class="detail-value">${accident.severity}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ìƒíƒœ:</span>
                <span class="detail-value status-${accident.status}">${getStatusText(accident.status)}</span>
              </div>
            </div>
            <div class="detail-section">
              <h3>ğŸ“ ìœ„ì¹˜ ì •ë³´</h3>
              <div class="detail-item">
                <span class="detail-label">ì‚¬ê³  ì¥ì†Œ:</span>
                <span class="detail-value">${accident.location}</span>
              </div>
            </div>
            <div class="detail-section">
              <h3>ğŸ‘¤ ìƒëŒ€ë°© ì •ë³´</h3>
              <div class="detail-item">
                <span class="detail-label">ì´ë¦„:</span>
                <span class="detail-value">${accident.otherDriverName || 'ì •ë³´ ì—†ìŒ'}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ì—°ë½ì²˜:</span>
                <span class="detail-value">${accident.otherDriverPhone || 'ì •ë³´ ì—†ìŒ'}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ë©´í—ˆë²ˆí˜¸:</span>
                <span class="detail-value">${accident.otherDriverLicense || 'ì •ë³´ ì—†ìŒ'}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ì°¨ëŸ‰ë²ˆí˜¸:</span>
                <span class="detail-value">${accident.otherVehiclePlate || 'ì •ë³´ ì—†ìŒ'}</span>
              </div>
            </div>
          </div>
          ${accident.description ? `
            <div class="detail-section">
              <h3>ğŸ“ ìƒì„¸ ì„¤ëª…</h3>
              <p>${accident.description}</p>
            </div>
          ` : ''}
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal()">ë‹«ê¸°</button>
          <button class="btn btn-primary" onclick="editAccident('${accidentId}')">ìˆ˜ì •í•˜ê¸°</button>
        </div>
      </div>
    `;
    document.body.appendChild(modal);
  }

  // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‚¬ê³  ëª©ë¡ ë¡œë“œ
  document.addEventListener('DOMContentLoaded', function() {
    loadAccidents();
  });
  </script>

  <style>
  /* Accident Cards */
  .accident-card {
    border-left: 4px solid var(--warning);
  }

  .accident-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 1rem;
  }

  .accident-info h3 {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--gray-800);
    margin-bottom: 0.25rem;
  }

  .accident-date {
    color: var(--gray-600);
    font-size: 0.875rem;
  }

  .accident-details {
    margin-bottom: 1rem;
  }

  .detail-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid var(--gray-200);
  }

  .detail-row:last-child {
    border-bottom: none;
  }

  .detail-label {
    font-weight: 500;
    color: var(--gray-700);
  }

  .detail-value {
    color: var(--gray-800);
    font-weight: 600;
  }

  .accident-actions {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  /* Form Sections */
  .form-section {
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid var(--gray-200);
  }

  .form-section:last-child {
    border-bottom: none;
    margin-bottom: 0;
  }

  .form-section h3 {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--gray-800);
    margin-bottom: 1rem;
  }

  /* Photo Upload */
  .photo-upload-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
  }

  .photo-upload-item {
    text-align: center;
  }

  .photo-upload-label {
    cursor: pointer;
    display: block;
  }

  .photo-upload-box {
    border: 2px dashed var(--gray-300);
    border-radius: 0.5rem;
    padding: 2rem 1rem;
    transition: all 0.2s ease;
  }

  .photo-upload-box:hover {
    border-color: var(--primary-blue);
    background: var(--light-blue);
  }

  .photo-upload-box span {
    font-size: 2rem;
    display: block;
    margin-bottom: 0.5rem;
  }

  .photo-upload-box p {
    color: var(--gray-600);
    font-size: 0.875rem;
    margin: 0;
  }

  .photo-upload-input {
    display: none;
  }

  .photo-preview {
    margin-top: 1rem;
  }

  /* Modal Large */
  .modal-large {
    max-width: 800px;
    width: 90%;
  }

  /* Accident Detail Grid */
  .accident-detail-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
  }

  /* Status Colors */
  .status-pending {
    color: var(--warning);
  }

  .status-in-progress {
    color: var(--primary-blue);
  }

  .status-completed {
    color: var(--success);
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .accident-header {
      flex-direction: column;
      gap: 1rem;
    }

    .accident-actions {
      justify-content: center;
    }

    .photo-upload-grid {
      grid-template-columns: 1fr;
    }

    .accident-detail-grid {
      grid-template-columns: 1fr;
      gap: 1rem;
    }
  }
  </style>
</body>
</html> 